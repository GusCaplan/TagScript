<html>
<head>
<link rel="stylesheet" href="codemirror.css">
<link rel="stylesheet" href="codemirror-material.css">
</head>
<style>
  .CodeMirror {
    font-size: 125% !important;
    width: 75%;
  }
  .cm-brace { color: #268BD2 !important; }
  .cm-comment.cm-matchingbrace {
    text-decoration: none;
    color: #546E7A !important;
  }
  .cm-matchingbrace {
    color: #8acfff !important;
    text-decoration: underline;
  }
  .cm-function { color: #DC322F !important; }
  .cm-semi { color: #E0BF45 !important; }
  .cm-argument { color: #79d655 !important; }
  .cm-string { color: #CFD8DC !important; }
</style>
<body>
<textarea id="ide">{note: have fun!}</textarea>
<script src="codemirror.js"></script>
<script src="mode-simple.js"></script>
<script src="matchBrackets.js"></script>
<script src="bundle.js"></script>
<script>
CodeMirror.defineSimpleMode("tagscript", {
  start: [
    {regex: /\{note/, token: 'comment', next: 'comment'},
    {regex: /\{/, token: 'brace', next: 'function', indent: true}
  ],
  comment: [
    {regex: /.*?\}/, token: 'comment', next: 'start'},
    {regex: /.*/, token: 'comment'},
  ],
  'function': [
    {regex: /[^{};]+/, token: 'function', next: 'outerTag'}
  ],
  outerTag: [
    {regex: /\{/, token: 'brace', push: 'innerTag', indent: true},
    {regex: /\}/, token: 'brace', next: 'start', dedent: true},
    {regex: /;/, token: 'semi', push: 'args'},
    {regex: /[^{};]+/, token: 'string'}
  ],
  innerTag: [
    {regex: /\{/, token: 'brace', push: 'innerTag', indent: true},
    {regex: /\}/, token: 'brace', pop: true, dedent: true},
    {regex: /;/, token: 'semi', push: 'args'},
    {regex: /[^{};]+/, token: 'function'}
  ],
  args: [
    {regex: /\{/, token: 'brace', push: 'innerTag', indent: true},
    {regex: /\}/, token: 'brace', pop: true, dedent: true},
    {regex: /;/, token: 'semi'},
    {regex: /[^{};]+/, token: 'argument'}
  ],
  meta: {}
});

var editor = CodeMirror.fromTextArea(document.querySelector('#ide'), {
  mode: 'tagscript',
  lineNumbers: true,
  theme: 'material',
  matchBrackets: true,
  hintOptions: {
    words: [
      {text: 'math', displayText: '{math;operators}'}
    ]
  },
  lineWrapping: true
});
</script>
</body>
</html>
